<% gcp_project_id = "#{external_attribute(pwd, 'gcp_project_id', doc_generation)}" -%>
<% dlp = grab_attributes(pwd)['dlp'] -%>


describe google_data_loss_prevention_stored_info_types(project: <%= gcp_project_id -%>, location: <%= doc_generation ? "'#{dlp['location']}'" : "dlp['location']" -%>) do
it { should exist }
its('names') { should include <%= doc_generation ? "'#{dlp['name']}'" : "dlp['name']" -%> }
its('types') { should include <%= doc_generation ? "'#{dlp['type']}'" : "dlp['type']" -%> }
its('states') { should include <%= doc_generation ? "'#{dlp['state']}'" : "dlp['state']" -%> }
end